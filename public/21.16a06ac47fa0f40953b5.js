(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{wMrW:function(t,e,i){"use strict";i.r(e),i.d(e,"NotificationsModule",(function(){return D}));var c=i("WT9V"),a=i("D57K"),n=i("IfiR"),o=i("YOe6"),r=i("2Mvu"),d=i("Jg5f"),s=i("Mumn"),l=i("LoAr"),p=i("GiBk"),u=function(){function t(t){this.http=t,this.api=s.a.mainUrl+s.a.apiUrl+"/notifications",this.apiMail=this.api+"/mail",this.apiSms=this.api+"/sms"}return t.prototype.getMailTemplates=function(){return this.http.get(this.apiMail).pipe(Object(d.a)((function(t){return t})))},t.prototype.saveMailTemplate=function(t){return this.http.post(this.apiMail,t).pipe(Object(d.a)((function(t){return t})))},t.prototype.updateMailTemplate=function(t){return this.http.put(this.apiMail,t).pipe(Object(d.a)((function(t){return t})))},t.prototype.deleteMailTemplate=function(t){return this.http.delete(this.apiMail+"/rem/"+t).pipe(Object(d.a)((function(t){return t})))},t.prototype.getSmsTemplates=function(){return this.http.get(this.apiSms).pipe(Object(d.a)((function(t){return t})))},t.prototype.saveSmsTemplate=function(t){return this.http.post(this.apiSms,t).pipe(Object(d.a)((function(t){return t})))},t.prototype.updateSmsTemplate=function(t){return this.http.put(this.apiSms,t).pipe(Object(d.a)((function(t){return t})))},t.prototype.deleteSmsTemplate=function(t){return this.http.delete(this.apiSms+"/rem/"+t).pipe(Object(d.a)((function(t){return t})))},t.\u0275fac=function(e){return new(e||t)(l.ic(p.b))},t.\u0275prov=l.Ub({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),m=i("LPaM"),f=i("iZ6s"),b=i("qjAt"),h=i("ZDS+"),v=i("X8C7");function y(t,e){if(1&t){var i=l.fc();l.ec(0,"div",22),l.Zb(1,"i",23),l.ec(2,"input",24),l.mc("input",(function(t){return l.Nc(i),l.qc(),l.Lc(11).filterGlobal(t.target.value,"contains")})),l.dc(),l.dc()}}function g(t,e){if(1&t&&(l.ec(0,"th",27),l.Yc(1),l.Zb(2,"p-sortIcon",28),l.dc()),2&t){var i=e.$implicit;l.yc("pSortableColumn",i.field),l.Kb(1),l.ad(" ",i.header," "),l.Kb(1),l.yc("field",i.field)}}function S(t,e){if(1&t&&(l.ec(0,"tr"),l.Wc(1,g,3,3,"th",25),l.ec(2,"th",26),l.Yc(3,"Options"),l.dc(),l.dc()),2&t){var i=e.$implicit;l.Kb(1),l.yc("ngForOf",i)}}function T(t,e){if(1&t){var i=l.fc();l.ec(0,"tr"),l.ec(1,"td"),l.Yc(2),l.dc(),l.ec(3,"td"),l.Yc(4),l.dc(),l.ec(5,"td"),l.ec(6,"button",29),l.mc("click",(function(){l.Nc(i);var t=e.$implicit;return l.qc(2).edit(t)})),l.Zb(7,"i",30),l.dc(),l.dc(),l.dc()}if(2&t){var c=e.$implicit;l.Kb(2),l.Zc(c.name),l.Kb(2),l.Zc(c.subject)}}var j=function(){return[10,15,20,25]};function w(t,e){if(1&t){var i=l.fc();l.ec(0,"div",11),l.ec(1,"div",3),l.Zb(2,"i",12),l.Yc(3," Email Massages Templates "),l.ec(4,"button",4),l.mc("click",(function(){return l.Nc(i),l.qc().refresh()})),l.Zb(5,"i",13),l.dc(),l.ec(6,"button",14),l.mc("click",(function(){return l.Nc(i),l.qc().add()})),l.Zb(7,"i",15),l.Yc(8," Add "),l.dc(),l.dc(),l.ec(9,"div",16),l.ec(10,"p-table",17,18),l.Wc(12,y,3,0,"ng-template",19),l.Wc(13,S,4,1,"ng-template",20),l.Wc(14,T,8,2,"ng-template",21),l.dc(),l.dc(),l.dc()}if(2&t){var c=l.qc();l.Kb(10),l.yc("autoLayout",!0)("columns",c.dataSetCols)("paginator",!0)("resizableColumns",!0)("rowsPerPageOptions",l.Cc(7,j))("rows",10)("value",c.dataSet)}}function M(t,e){1&t&&(l.ec(0,"div",48),l.ec(1,"div"),l.Yc(2,"Template Name is required"),l.dc(),l.dc())}function C(t,e){1&t&&(l.ec(0,"div",48),l.ec(1,"div"),l.Yc(2,"Subject is required"),l.dc(),l.dc())}var I=function(t){return{"is-invalid":t}};function O(t,e){if(1&t){var i=l.fc();l.ec(0,"div",31),l.ec(1,"div",32),l.ec(2,"h4",33),l.Yc(3,"Save Template"),l.dc(),l.ec(4,"button",34),l.mc("click",(function(){return l.Nc(i),l.qc().saveModal.hide()})),l.ec(5,"span",35),l.Yc(6,"\xd7"),l.dc(),l.dc(),l.dc(),l.ec(7,"form",36),l.mc("ngSubmit",(function(){return l.Nc(i),l.qc().submitTemplate()})),l.ec(8,"div",37),l.ec(9,"div",38),l.ec(10,"label",39),l.Yc(11,"Template Name"),l.dc(),l.ec(12,"div",40),l.Zb(13,"input",41),l.Wc(14,M,3,0,"div",42),l.dc(),l.dc(),l.ec(15,"div",38),l.ec(16,"label",43),l.Yc(17,"Template Subject"),l.dc(),l.ec(18,"div",40),l.Zb(19,"textarea",44),l.Wc(20,C,3,0,"div",42),l.dc(),l.dc(),l.dc(),l.ec(21,"div",45),l.ec(22,"button",46),l.mc("click",(function(){return l.Nc(i),l.qc().saveModal.hide()})),l.Yc(23,"Close"),l.dc(),l.ec(24,"button",47),l.Yc(25,"Save Template"),l.dc(),l.dc(),l.dc(),l.dc()}if(2&t){var c=l.qc();l.Kb(7),l.yc("formGroup",c.addEditForm),l.Kb(6),l.yc("ngClass",l.Dc(6,I,c.f.name.errors)),l.Kb(1),l.yc("ngIf",c.f.name.errors),l.Kb(5),l.yc("ngClass",l.Dc(8,I,c.f.subject.errors)),l.Kb(1),l.yc("ngIf",c.f.subject.errors),l.Kb(4),l.yc("disabled",c.addEditForm.invalid)}}var k=function(){return{width:"50vw"}},Y=function(){function t(t,e,i,c){this.http=t,this.modalService=e,this.messageService=i,this.formBuilder=c,this.view=1,this.dataSetCols=[],this.dataSet=[],this.dataLoaded=!1,this.submitted=!1,this.templates=[],this.projectId=4667,this.templateId=24269,this.curData=new o.a}return Object.defineProperty(t.prototype,"f",{get:function(){return this.addEditForm.controls},enumerable:!0,configurable:!0}),t.prototype.refresh=function(){var t=this;this.http.getMailTemplates().pipe(Object(r.a)()).subscribe((function(e){t.dataSet=Object(a.i)(e),t.dataLoaded=!0}))},t.prototype.add=function(){unlayer.loadTemplate(this.templateId),this.view=2},t.prototype.edit=function(t){this.curData=t,unlayer.loadDesign(JSON.parse(t.json)),this.view=2},t.prototype.ngOnInit=function(){this.initEditor(),this.dataSetCols=[{field:"name",header:"Name"},{field:"subject",header:"Subject"}],this.refresh()},t.prototype.saveSnippet=function(t){this.addEditForm=this.formBuilder.group({id:[this.curData.id],subject:[this.curData.subject,n.x.required],name:[this.curData.name,n.x.required]}),this.saveModal=this.modalService.show(t)},t.prototype.close=function(){this.view=1},t.prototype.submitTemplate=function(){var t=this,e=this.addEditForm.value;unlayer.exportHtml((function(i){if(e.json=JSON.stringify(i.design),e.template=i.html,t.saveModal.hide(),t.curData.id)return t.put(e);t.http.saveMailTemplate(e).pipe(Object(r.a)()).subscribe((function(e){t.dataSet.push(e),t.close(),t.messageService.add({severity:"success",summary:"Save Success",detail:e.name+" Template Saved Successfully!"})}))}))},t.prototype.put=function(t){var e=this;this.http.updateMailTemplate(t).pipe(Object(r.a)()).subscribe((function(t){var i=e.dataSet;i[e.dataSet.indexOf(e.curData)]=t,e.dataSet=i,e.close(),e.messageService.add({severity:"success",summary:"Update Success",detail:t.name+" Mail Template Updated Successfully!"})}))},t.prototype.initEditor=function(){var t=this,e=this.unlayerScript=document.createElement("script");e.setAttribute("src","//editor.unlayer.com/embed.js"),e.onload=function(){t.loadEditor()},document.head.appendChild(e)},t.prototype.loadEditor=function(){unlayer.init({id:"editor",projectId:this.projectId,templateId:this.templateId,displayMode:"email"}),unlayer.addEventListener("design:loaded",(function(t){console.log("unlayer loaded")}))},t.\u0275fac=function(e){return new(e||t)(l.Yb(u),l.Yb(m.a),l.Yb(f.g),l.Yb(n.d))},t.\u0275cmp=l.Sb({type:t,selectors:[["app-template"]],inputs:{projectId:"projectId",templateId:"templateId"},decls:17,vars:8,consts:[[1,"",3,"hidden"],["class","card animated fadeIn",4,"ngIf"],[1,"card"],[1,"card-header"],["type","button",1,"btn","btn-sm","btn-dark","ml-2","mr-1","float-right",3,"click"],[1,"fa","fa-close"],["type","button",1,"btn","btn-sm","btn-success","ml-2","mr-1","float-right",3,"click"],[1,"fa","fa-save"],[1,"card-body",2,"overflow-y","scroll"],["id","editor"],["saveTemp",""],[1,"card","animated","fadeIn"],[1,"fa","fa-users"],[1,"fa","fa-refresh"],["type","button",1,"btn","btn-sm","btn-info","ml-2","mr-1","float-right",3,"click"],[1,"fa","fa-plus"],[1,"card-body"],["columnResizeMode","fit","sortMode","multiple",3,"autoLayout","columns","paginator","resizableColumns","rowsPerPageOptions","rows","value"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[2,"text-align","right"],[1,"fa","fa-search",2,"margin","4px 4px 0 0"],["pInputText","","placeholder","Search table","size","50","type","text",2,"width","auto",3,"input"],["pResizableColumn","",3,"pSortableColumn",4,"ngFor","ngForOf"],["pResizableColumn",""],["pResizableColumn","",3,"pSortableColumn"],[3,"field"],["title","Edit Template","type","button",1,"btn","btn-xs","btn-warning","m-1",3,"click"],[1,"fa","fa-edit"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["aria-label","Close","type","button",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"form-group","row"],["for","title",1,"col-md-3","col-form-label"],[1,"col-md-9"],["autofocus","","formControlName","name","id","title","placeholder","Template Name...","type","text",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","description",1,"col-md-3","col-form-label"],["formControlName","subject","id","description","placeholder","Mail description...","rows","2","type","text",1,"form-control",3,"ngClass"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-block","btn-success",3,"disabled"],[1,"invalid-feedback"]],template:function(t,e){if(1&t){var i=l.fc();l.ec(0,"div"),l.ec(1,"div",0),l.Wc(2,w,15,8,"div",1),l.dc(),l.ec(3,"div",0),l.ec(4,"div",2),l.ec(5,"div",3),l.Yc(6," Add / Edit Mail Template "),l.ec(7,"button",4),l.mc("click",(function(){return e.close()})),l.Zb(8,"i",5),l.dc(),l.ec(9,"button",6),l.mc("click",(function(){l.Nc(i);var t=l.Lc(16);return e.saveSnippet(t)})),l.Zb(10,"i",7),l.Yc(11," Save Template "),l.dc(),l.dc(),l.ec(12,"div",8),l.Zb(13,"div",9),l.dc(),l.dc(),l.dc(),l.dc(),l.Zb(14,"p-confirmDialog"),l.Wc(15,O,26,10,"ng-template",null,10,l.Xc)}2&t&&(l.Kb(1),l.yc("hidden",2==e.view),l.Kb(1),l.yc("ngIf",e.dataLoaded),l.Kb(1),l.yc("hidden",1==e.view),l.Kb(10),l.Vc("height",500,"px"),l.Kb(1),l.Uc(l.Cc(7,k)))},directives:[c.m,b.a,h.d,f.i,v.a,c.l,h.a,h.c,h.b,n.z,n.q,n.i,n.c,n.p,n.g,c.k],encapsulation:2}),t}(),K=i("n47m"),N=i("ptv/"),q=i("981U"),Z=function(){function t(){}return t.prototype.ngOnInit=function(){},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Sb({type:t,selectors:[["app-sms"]],decls:2,vars:0,template:function(t,e){1&t&&(l.ec(0,"p"),l.Yc(1,"sms works!"),l.dc())},styles:[""]}),t}(),x=i("gqzJ"),E=[{path:"email",component:Y,data:{title:"Mail Templates"}},{path:"",component:Y,data:{title:"Mail Templates"}},{path:"short_msgs",component:Z,data:{title:"Short Messages"}}],D=function(){function t(){}return t.\u0275mod=l.Wb({type:t}),t.\u0275inj=l.Vb({factory:function(e){return new(e||t)},providers:[f.b,{provide:K.d,useValue:"en-NG"},{provide:K.c,useValue:N.a},{provide:K.a,useClass:x.a}],imports:[[c.c,q.g.forChild(E),h.e,v.b,b.b,n.u,m.b.forRoot()]]}),t}()}}]);